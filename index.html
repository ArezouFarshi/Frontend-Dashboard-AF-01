<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <!-- FORCE LANDSCAPE ON MOBILE -->
  <style>
    @media screen and (max-width: 900px) and (orientation: portrait) {
      body {
        transform: rotate(90deg);
        transform-origin: left top;
        width: 100vh;
        height: 100vw;
        overflow: hidden;
        position: absolute;
        top: 0;
        left: 0;
      }
    }
  </style>

  <title>DPP Dashboard — Smart Façade Panels</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- ROTATE WARNING -->
  <div id="rotateWarning" style="
    display:none;
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:#000;
    color:#fff;
    font-size:20px;
    padding:20px;
    text-align:center;
    z-index:9999;
  ">
    Please rotate your phone to landscape to view the dashboard.
  </div>

  <header class="hero">
    <div class="hero__content">
      <h1>Blockchain-Powered DPP</h1>
      <p class="subtitle">Façade Lifecycle Assessment</p>
    </div>
  </header>

  <main class="container">
    <!-- Panel selector -->
    <section class="panel-selector card">
      <h2>Select panel</h2>
      <div class="form-row">
        <label for="panelId"><span>Panel ID</span></label>
        <input type="text" id="panelId" placeholder="e.g., ID_27_C_42" />

        <label for="accessCode"><span>Access code</span></label>
        <input type="text" id="accessCode" placeholder="Enter your code" />
      </div>
      <div class="form-row">
        <label for="accessTier"><span>Access tier</span></label>
        <select id="accessTier">
          <option value="public">Public</option>
          <option value="tier1">Tier 1</option>
          <option value="tier2">Tier 2</option>
        </select>

        <button id="btnLoadAll">Load panel data</button>
      </div>
      <p class="hint">Insert your access code to unlock the information</p>
    </section>

    <!-- Project information -->
    <section class="project-info card">
      <h2>Project information</h2>
      <div id="projectMeta" class="meta-grid"></div>
    </section>

    <!-- Performance Overview (title always visible, content filled after data is loaded) -->
    <section class="performance-overview card">
      <h2>Performance Overview</h2>
      <div id="perfContent">
        <!-- This content will be dynamically filled after loading -->
      </div>
    </section>

    <!-- Blockchain Logs -->
    <section class="events card">
      <div class="section-header">
        <h2>Blockchain Logs</h2>
        <div class="legend">
          <span class="badge b-blue">normal</span>
          <span class="badge b-yellow">warning</span>
          <span class="badge b-red">fault</span>
          <span class="badge b-purple">system error</span>
        </div>
      </div>
      <div id="eventsHelp" class="muted">Click “Load panel data” to fetch anomaly history.</div>
      <table id="eventsTable" class="hidden">
        <thead>
          <tr>
            <th>Timestamp</th>
            <th>Prediction</th>
            <th>Color</th>
            <th>Status</th>
            <th>Reason</th>
            <th>TX</th>
          </tr>
        </thead>
        <tbody id="eventsBody"></tbody>
      </table>
    </section>

    <!-- Digital Product Passport -->
    <section class="dpp-json card">
      <div class="section-header">
        <h2>Digital Product Passport</h2>
        <div class="actions">
          <a id="jsonLink" href="#" target="_blank">Open raw JSON</a>
          <button id="btnLoadDpp">Refresh JSON</button>
        </div>
      </div>
      <pre id="jsonOut" class="code"></pre>
    </section>
  </main>

  <!-- Modal for "Please wait..." -->
  <div id="perfLoadingModal" class="modal hidden">Please wait a few seconds for the information to be loaded.</div>

<footer class="footer">
  <p>Powered by Blockchain, Sepolia Testnet • One backend/one frontend for all panels</p>
  <div class="footer-logo">
    <img src="public/assets/logo.png" alt="Platform Logo">
  </div>
</footer>

<!-- Ethers v6 UMD -->
<script src="https://cdn.jsdelivr.net/npm/ethers@6.7.0/dist/ethers.umd.min.js"></script>

<!-- Chart.js (required for performance graphs) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Chart.js time adapter (REQUIRED for system error graph) -->
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>

<script src="dashboard.js"></script>


